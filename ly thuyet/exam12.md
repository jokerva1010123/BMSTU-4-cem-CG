# 12. Двумерное отсечение. Простой алгоритм отсечения отрезка.

## Отсечение

**Отсечение** – операция удаления части изображения, находящейся за пределами выделенной области, называемой отсекателем.
Отсечение используется в алгоритмах удаления невидимых линий поверхностей и в некоторых алгоритмах учёта теней, поэтому от нас не только требуется скопировать или сохранить изображение, расположенное в пределах отсекателя, но и решить геометрическую задачу нахождения геометрических характеристик изображения, чтобы использовать их при решении других задач.
Также существует понятие стирания изображения – это операция удаления части изображения, находящейся в пределах заданной области (то есть отсекателя).

Само по себе отсечение может проводиться в двумерном или трёхмерном пространствах. При этом, трёхмерный случай является обобщением двумерного случая. То есть, умея решать задачу в двумерном пространстве, не составит труда реализовать и решить её и в трёхмерном пространстве.

Существует следующая классификация двумерных отсекателей:

- Регулярный (стандартный) отсекатель – это отсекатель прямоугольной формы со сторонами, параллельными координатным осям.

- Нерегулярный отсекатель – отсекатель формы произвольного выпуклого многоугольника.

- Более сложные отсекатели – отсекатели формы произвольного невыпуклого многоугольника.

Также не будет лишним привести классификацию трёхмерных отсекателей:

- Отсекатели формы прямоугольного параллелепипеда

- Отсекатели формы четырёхгранной усечённой пирамиды.

Следует отметить, что границу отсекателя принято относить к внутренней области отсечения.

## Отсечение отрезков регулярным отсекателем
Перед тем, как обратиться к простому алгоритму отсечения отрезка регулярным отсекателем, нам потребуется решить задачу определения принадлежности заданного отрезка к области отсечения.

На следующей картинке определены три отрезка:

![](https://sun1-85.userapi.com/UwaRanN0feKlKwVufuKDtcpOD1recRa5HtHZqA/ZECQyr0m2pM.jpg)

Каждый из отрезков относительно отсекаемой области будет являться: полностью видимым (крайний левый отрезок), частично видимым (средний отрезок) или полностью невидимым (крайний правый отрезок).

Как видно из рисунка, для того чтобы определить принадлежность каждой из вершин отрезка отсекаемой области, достаточно проверить условие:

x_л≤x≤x_п  и y_н≤y≤y_в

Каждый раз при обработке очередного отрезка проверять выполнения данных неравенств не очень удобно, поэтому было предложено формализовать данную процедуру и характеризовать положение точки четырёхразрядным кодом.

Каждый разряд в таком коде определяет положение точки относительно каждой из границ отсекателя. Обозначим такой код буквой T.

В таком коде для каждой точки будем иметь:
```
T_1=1,если x<x_л,а иначе:0
T_2=1,если x>x_п,а иначе: 0
T_3=1,если y<y_н,а иначе: 0
T_4=1,если y>y_в,а иначе: 0
```

Стоит отметить, что в координатах экрана в условиях для T_3 и T_4 знаки строгого неравенства поменяются между собой местами, так как в этом случае y_н>y_в.

Таким образом, точка будет видима в том случае, если поразрядная сумма её кода будет равна нулю.
Получается, что и отрезок будет полностью видим в том случае, если поразрядные суммы кодов концов этого отрезка равны нулю: S_1=0 и S_2=0.

Если отрезок не является полностью видимым, то он может являться либо частично видимым, либо полностью невидимым.
Возникает необходимость вновь «упростить» задачу и найти способ определить полную невидимость отрезка относительно заданного регулярного отсекателя.

Ниже приведены два вида полностью невидимых отрезков:

![](https://sun1-88.userapi.com/kR5zvQkUCpp3PC3omuQyboDERqCkkTOlnHcZ4g/GDxHzY0GRoQ.jpg)

![](https://sun1-25.userapi.com/LprIDGzw-JD_qHy-Q2_tI-96QyAyf8b9EcIKkQ/gSPTz8tc6Yk.jpg)

Сразу стоит обговорить тот факт, что для вида полностью невидимых отрезков, предоставленного на втором рисунке, с помощью простого анализа кодов концов отрезков определить полную невидимость не получается.

Для определения полной невидимости отрезков, которые располагаются относительно отсекателя вполне определённым способом (Рисунок 2: полностью ниже нижней границы отсекателя, полностью левее левой границы, полностью правее правой границы, полностью выше верхней границы), достаточно провести следующий простой тест:

Если T_I&T_II≠0,то отрезок полностью невидимый, где & - поразрядное логические «и», а T_I- код первого конца отрезка и T_II- код второго конца отрезка.

При этом мы также имеем возможность определить частичную видимость следующим простым тестом:
```
Если S_1=0 и S_2≠0,то отрезок заведомо частично видимый
Если S_2=0 и S_1≠0,то отрезок заведомо частично видимый
```
Для таких отрезков от нас потребуется найти вторую вершину видимой части. При этом потребуется искать только одну координату точки пересечения, так как вторая координата будет совпадать с параметром границы отсекателя (для верхней и нижней границы это будет значение ординаты, а для левой и правой границы – значение абсциссы).

![](https://sun1-96.userapi.com/XEydQCwnFkK5J3GfnqCVWg3tChOzsPaVAdztSA/rmbj-G6lBcc.jpg)

![](https://sun9-7.userapi.com/634E5Os-XQTZticulhFzlZqxJaGxvUGaJzpL2g/MEe9gqVwdVg.jpg)

## Алгоритм

![](https://sun1-22.userapi.com/I2s0J81uVSf5e2HEQEspUFOtpIQqBEKU64zASg/DRjjuP4W3AE.jpg)

![](https://sun9-51.userapi.com/MsKcEMAsrq-t-DlqWJrbWG5dlM_cKnZb1yL5lQ/2xXWKWierUU.jpg)

![](https://sun9-32.userapi.com/475Q0TOXyZpK8nxCWqjsfWgSLKJF6YKLXKHn4A/bWJrI-KOhkk.jpg)

![](https://sun9-30.userapi.com/ma93v0u-I2lMOgUipEJdoIIXZVNVbovGY04QaQ/KtO_R6ZHEwA.jpg)

![](https://sun9-20.userapi.com/6phBHC54IG7AvxEnQlkenuw1qxpOlkCkcFJOjg/pUVXeI-AMF4.jpg)

![](https://sun1-30.userapi.com/L5CkPXXju248vfe-WQjfVq1GIPdJPUsdVz4-bQ/tZ5mvib-EAQ.jpg)

![](https://sun1-89.userapi.com/UZP6LA1_BHvhk2l-6W4kE7VCyxPLcihL_wXLbw/b_9bO1qQs5M.jpg)

![](https://sun1-89.userapi.com/ZWCCiMVsr57H9uR2-O1n6TsixSN7AzODYkakuA/x71ThhShRp4.jpg)

![Фото заряжено на пересдачу](https://sun1-90.userapi.com/hawhdIGcGD4aCEjeYR6h3X_ufMsamFaxJCIMxw/XoVv8cAKeCA.jpg)

**Следующий вопрос:**  [13. Отсечение. Алгоритм Сазерленда Коэна отсечения отрезка.](./exam13)


**Предыдущий вопрос:**  [11. Основы методов устранения ступенчатости. Алгоритм Брезенхема с устранением ступенчатости. Алгоритм Ву.](./exam11)
